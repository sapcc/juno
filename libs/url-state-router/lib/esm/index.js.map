{"version":3,"file":"index.js","sources":["../../src/RouterContext.js","../../src/useURLStateProvider.js","../../src/Router.js","../../src/routeMatcher.js","../../src/Route.js","../../src/Switch.js","../../src/Redirect.js","../../src/Link.js"],"sourcesContent":["import { createContext, useContext } from \"react\"\n\nexport const RouterContext = createContext({ insideRouter: false })\nexport const useRouter = () => {\n  const context = useContext(RouterContext)\n\n  if (!context || !context.insideRouter) {\n    console.warn(\n      \"You should not use <Route>, <Switch>, <Redirect> or <Link> outside a <Router>\"\n    )\n  }\n  return context\n}\n","import { useState, useEffect } from \"react\"\nimport { registerConsumer } from \"url-state-provider\"\n\nconst useURLStateProvider = (stateID) => {\n  const [navigation, setNavigation] = useState()\n  const [state, setState] = useState()\n\n  useEffect(() => {\n    const { push, replace, onChange, currentState } = registerConsumer(stateID)\n    const unregisterConsumer = onChange(setState)\n\n    setState(currentState() || {})\n\n    const navigation = {\n      navigateTo: (path, options) => push({ p: path, o: options }),\n      redirectTo: (path, options) => replace({ p: path, o: options }),\n    }\n    setNavigation(navigation)\n    return unregisterConsumer\n  }, [stateID])\n\n  if (!navigation) return null\n\n  return {\n    state,\n    navigateTo: navigation.navigateTo,\n    redirectTo: navigation.redirectTo,\n  }\n}\n\nexport default useURLStateProvider\n","import { RouterContext } from \"./RouterContext\"\nimport useURLStateProvider from \"./useURLStateProvider\"\n\nconst Router = ({ stateID, children }) => {\n  const URLStateProvider = useURLStateProvider(stateID)\n  if (!URLStateProvider) return null\n\n  return (\n    <RouterContext.Provider\n      value={{\n        insideRouter: true,\n        currentPath: URLStateProvider.state.p || \"/\",\n        options: URLStateProvider.state.o,\n        navigateTo: URLStateProvider.navigateTo,\n        redirectTo: URLStateProvider.redirectTo,\n      }}\n    >\n      {children}\n    </RouterContext.Provider>\n  )\n}\n\nexport default Router\n","/**\n * This function compares the current path with the route path and returns an array.\n * The first element in the array is a boolean that indicates whether the comparison\n * was successful. The second element contains route parameters if the route path\n * contains placeholders in the form of \":VAR_NAME\".\n * @param {string} currentPath currently active path\n * @param {string} routePath route path to be compared with the current path\n * @param {object} options exact: bool\n * @returns routeParams\n */\nconst routeMatcher = (currentPath, routePath, options) => {\n  let log = [\"currentPath:\", currentPath, \"routePath:\", routePath]\n\n  if (!routePath || !currentPath) {\n    console.info(\"%c\" + log.join(\" \"), \"color: #A52A2A\")\n    return [false]\n  }\n\n  options = options || {}\n  // remove spaces at the beginning and end of routePath and currentPath\n  routePath = routePath.trim()\n  currentPath = currentPath.trim()\n\n  // build regex from path by replacing all \":var\" with \"(.+)\"\n  let regexString = \"^\" + routePath.replace(/:[^\\/]+/g, \"(.+)\")\n  // add \"$\" at the end of regex if exact is set\n  if (options.exact) regexString += \"$\"\n\n  const regex = new RegExp(regexString)\n  const match = currentPath.match(regex)\n\n  log = log.concat([\"regexString:\", regexString])\n  if (!match) {\n    console.info(\"%c\" + log.join(\" \"), \"color: #D2691E\")\n    return [false]\n  }\n\n  // Find all parts of the route path that begin with \":\"\n  const paramKeys = routePath\n    .split(\"/\")\n    .filter((part) => part.startsWith(\":\"))\n    .map((key) => key.replace(\":\", \"\"))\n\n  let routeParams = {}\n  for (let i = 1; i <= match.length; i++) {\n    const key = paramKeys[i - 1]\n    if (!key) continue\n    routeParams[key] = match[i]\n  }\n\n  log = log.concat([\"routeParams\", JSON.stringify(routeParams)])\n  console.info(\"%c\" + log.join(\" \"), \"color: #7FFF00\")\n  return [true, routeParams]\n}\n\nexport default routeMatcher\n","import { useMemo, createElement } from \"react\"\nimport { useRouter } from \".\"\nimport { RouterContext } from \"./RouterContext\"\nimport routeMatcher from \"./routeMatcher\"\n\nconst Route = ({ path, exact, children, component }) => {\n  const { currentPath, options, ...otherProps } = useRouter()\n  const [match, routeParams] = useMemo(\n    () => routeMatcher(currentPath, path, { exact }),\n    [currentPath, path, exact]\n  )\n\n  if (!match) return null\n\n  return (\n    <RouterContext.Provider\n      value={{ path: currentPath, options, routeParams, ...otherProps }}\n    >\n      {component ? createElement(component) : children}\n    </RouterContext.Provider>\n  )\n}\n\nexport default Route\n","import React, { useMemo } from \"react\"\nimport routeMatcher from \"./routeMatcher\"\nimport { useRouter } from \".\"\n\n/**\n *\n * @param {object} props\n * @returns component\n */\nconst Switch = ({ children }) => {\n  const { currentPath } = useRouter()\n\n  const route = useMemo(() => {\n    let element\n    // We use React.Children.forEach instead of React.Children.toArray().find()\n    // here because toArray adds keys to all child elements and we do not want\n    // to trigger an unmount/remount for two <Route>s that render the same\n    // component at different URLs.\n    React.Children.forEach(children, (child) => {\n      if (\n        !element &&\n        React.isValidElement(child) &&\n        child.type.name === \"Route\"\n      ) {\n        const [match, _] = routeMatcher(currentPath, child.props.path, {\n          exact: child.props.exact,\n        })\n        if (match) element = child\n      }\n    })\n\n    return element\n  }, [currentPath, children])\n\n  return route ? React.cloneElement(route) : null\n}\n\nexport default Switch\n","import { useEffect } from \"react\"\nimport { useRouter } from \".\"\n\nconst Redirect = ({ to }) => {\n  const { redirectTo } = useRouter()\n\n  useEffect(() => {\n    redirectTo(to)\n  }, [])\n  return null\n}\n\nexport default Redirect\n","import { useRouter } from \".\"\n\nconst Link = ({ to, children, ...props }) => {\n  const { navigateTo } = useRouter()\n\n  return (\n    <a\n      {...props}\n      href=\"#\"\n      onClick={(e) => {\n        e.preventDefault()\n        navigateTo(to)\n      }}\n    >\n      {children}\n    </a>\n  )\n}\n\nexport default Link\n"],"names":["RouterContext","createContext","insideRouter","useRouter","context","useContext","console","warn","useURLStateProvider","stateID","useState","navigation","setNavigation","state","setState","useEffect","registerConsumer","push","replace","onChange","currentState","unregisterConsumer","navigateTo","path","options","p","o","redirectTo","Router","children","URLStateProvider","React","Provider","value","currentPath","routeMatcher","routePath","log","info","join","trim","regexString","exact","regex","RegExp","match","concat","key","paramKeys","split","filter","part","startsWith","map","routeParams","i","length","JSON","stringify","Route","component","otherProps","useMemo","createElement","Switch","route","element","Children","forEach","child","isValidElement","type","name","props","cloneElement","Redirect","to","Link","href","onClick","e","preventDefault"],"mappings":"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"}