/*
 * SPDX-FileCopyrightText: 2024 SAP SE or an SAP affiliate company and Juno contributors
 * SPDX-License-Identifier: Apache-2.0
 */

import React, { useMemo } from "react"
import {
  THREAD_LEVEL_LOW,
  THREAD_LEVEL_MEDIUM,
  THREAD_LEVEL_HIGH,
  THREAD_LEVEL_CRITICAL,
} from "../helpers"
import CustomBadge from "./CustomBadge"

const badgeCss = `
  mr-2
`

const VulnerabilityBadge = ({ level, label }) => {
  const icon = useMemo(() => {
    const threadLevel = level || ""
    switch (threadLevel.toLowerCase()) {
      case THREAD_LEVEL_LOW:
        return "severityLow"
      case THREAD_LEVEL_MEDIUM:
        return "severityMedium"
      case THREAD_LEVEL_HIGH:
        return "severityHigh"
      case THREAD_LEVEL_CRITICAL:
        return "severityCritical"
    }
  }, [level])

  const badgeVariant = useMemo(() => {
    const threadLevel = level || ""
    switch (threadLevel.toLowerCase()) {
      case THREAD_LEVEL_LOW:
        return "default"
      case THREAD_LEVEL_MEDIUM:
        return "warning"
      case THREAD_LEVEL_HIGH:
        return "danger"
      case THREAD_LEVEL_CRITICAL:
        return "critical"
    }
  }, [level])

  return (
    <CustomBadge
      className={badgeCss}
      badgeVariant={badgeVariant}
      icon={icon}
      label={label}
    />
  )
}

export default VulnerabilityBadge
