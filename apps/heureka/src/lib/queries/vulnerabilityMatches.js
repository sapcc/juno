import { gql } from "graphql-request"

// gql
// It is there for convenience so that you can get the tooling support
// like prettier formatting and IDE syntax highlighting.
// You can use gql from graphql-tag if you need it for some reason too.
export default () => gql`
  query ($filter: VulnerabilityMatchFilter, $first: Int, $after: String) {
    VulnerabilityMatches(filter: $filter, first: $first, after: $after) {
      __typename
      totalCount
      edges {
        node {
          id
          status
          remediationDate
          discoveryDate
          targetRemediationDate
          severity {
            value
            score
          }
          evidences {
            totalCount
            edges {
              node {
                id
                description
              }
              cursor
            }
            pageInfo {
              hasNextPage
              nextPageAfter
            }
          }
          vulnerabilityDisclosureId
          vulnerabilityDisclosure {
            id
            lastModified
          }
          componentInstanceId
          componentInstance {
            id
            ccrn
            count
          }
          vulnerabilityMatchChanges {
            totalCount
            edges {
              node {
                id
                action
                vulnerabilityMatchId
                activityId
              }
              cursor
            }
            pageInfo {
              hasNextPage
              nextPageAfter
            }
          }
        }
        cursor
      }
      pageInfo {
        hasNextPage
        hasPreviousPage
        isValidPage
        pageNumber
        nextPageAfter
        pages {
          after
          isCurrent
          pageNumber
          pageCount
        }
      }
    }
  }
`
