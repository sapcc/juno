platform: linux

image_resource:
  type: registry-image
  source:
    repository: keppel.eu-de-1.cloud.sap/ccloud/juno-v3-swift
    tag: "latest"

inputs:
  # TODO: scripte in das image reinbacken
  #       asset_storage script auf kind anpassen das es auch auf thirdparty hochladen kann
  - name: upload_dir # where the data is located that you want to upload

params:
  KIND: "third_party"
  ASSET_NAME:
  ASSET_PATH:
  OS_USERNAME:
  OS_PASSWORD:
  OS_AUTH_URL:
  OS_USER_DOMAIN_NAME:
  OS_PROJECT_DOMAIN_NAME:
  OS_PROJECT_NAME:

run:
  path: /bin/sh
  args:
    - -cx
    - |
      set -e cd
      /juno
      ./ci/scripts/asset_storage.sh --asset-name $ASSET_NAME --container juno-assets --asset-path $ASSET_PATH --action upload --root-path ../upload
      exit 1
